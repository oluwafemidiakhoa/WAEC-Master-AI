<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0f4c81" />
  <meta name="description" content="Offline-ready WAEC practice for 12 subjects: Mathematics, English, Physics, Chemistry, Biology, Economics, Government, Literature, Geography, Accounting, Commerce, Agricultural Science." />
  <title>WAEC Practice PWA</title>
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./icons/icon-192.png" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />
  <link rel="stylesheet" href="./css/styles.css" />
  
  <!-- Chart.js for analytics -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
</head>
<body>
  <main class="app">
    <header class="app__header">
      <div>
        <h1>WAEC Practice</h1>
        <p class="muted">Practice smarter, even offline ‚Äî short drills and exam mode for 12 WAEC subjects: Mathematics, English, Physics, Chemistry, Biology, Economics, Government, Literature, Geography, Accounting, Commerce, Agricultural Science.</p>
      </div>
      <div class="header__actions">
        <div class="header__controls">
          <!-- Theme Toggle -->
          <button id="themeToggle" class="icon-btn" type="button" title="Toggle theme">
            <svg class="theme-icon theme-icon--light" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="12" cy="12" r="5"></circle>
              <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
            </svg>
            <svg class="theme-icon theme-icon--dark hidden" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
          </button>
          
          <!-- Voice Toggle -->
          <button id="voiceToggle" class="icon-btn" type="button" title="Toggle voice narration">
            <svg class="voice-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <polygon points="11 5,6 9,2 9,2 15,6 15,11 19,11 5"></polygon>
              <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            </svg>
          </button>
          
          <!-- Help Button -->
          <button id="helpBtn" class="icon-btn" type="button" title="Help & Tutorial">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
              <path d="M12 17h.01"></path>
            </svg>
          </button>
        </div>
        
        <div id="statusPill" class="status">
          <span id="onlineStatus" class="status__dot"></span>
          <span id="statusText">Checking connection...</span>
        </div>
        
        <button id="installBtn" class="ghost hidden" type="button">Install App</button>
      </div>
    </header>

    <!-- Achievements Toast -->
    <div id="achievementToast" class="achievement-toast hidden">
      <div class="achievement-icon">üèÜ</div>
      <div class="achievement-content">
        <div class="achievement-title">Achievement Unlocked!</div>
        <div class="achievement-description">First quiz completed</div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading questions...</div>
    </div>

    <section id="about" class="card hero animate-fade-in">
      <div class="hero__content">
        <div class="hero__text">
          <span class="badge hero__badge">Offline-first</span>
          <h2>Study daily, see your progress.</h2>
          <p class="muted">
            A fast, low-data WAEC practice app covering 12 subjects: Mathematics, English, Physics, Chemistry, Biology, Economics,
            Government, Literature, Geography, Accounting, Commerce, Agricultural Science. Drill by topic, get instant feedback, and
            build a daily streak.
          </p>
          <div class="hero__actions">
            <a class="primary button-link" href="#setup">Start practice</a>
            <a class="ghost button-link" href="#dashboard">View dashboard</a>
            <button id="analyticsBtn" class="outline button-link" type="button">Analytics</button>
            <button id="achievementsBtn" class="outline button-link" type="button">Achievements</button>
            <button id="socialBtn" class="outline button-link" type="button">Social</button>
          </div>
        </div>
        <div class="hero__cards">
          <div class="hero__card">
            <h3>Instant feedback</h3>
            <p class="muted small">Explanations after every question.</p>
          </div>
          <div class="hero__card">
            <h3>Topic focus</h3>
            <p class="muted small">Filter by topic to fix weak areas faster.</p>
          </div>
          <div class="hero__card">
            <h3>Offline-ready</h3>
            <p class="muted small">Works offline once cached.</p>
          </div>
        </div>
      </div>
      <ul class="about__list">
        <li>Demo questions only ‚Äî no copyrighted WAEC past questions.</li>
        <li>Works offline once cached and saves progress in localStorage.</li>
        <li>Use Practice mode for drills or Timed Exam mode for test readiness.</li>
      </ul>
    </section>

    <!-- Advanced Analytics Card -->
    <section id="analytics" class="card hidden">
      <div class="analytics-header">
        <h2>Learning Analytics</h2>
        <button id="closeAnalytics" class="icon-btn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M18 6L6 18M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      
      <div class="analytics-grid">
        <div class="analytics-card">
          <h3>Performance Trends</h3>
          <canvas id="performanceChart" width="300" height="200"></canvas>
        </div>
        
        <div class="analytics-card">
          <h3>Time Analysis</h3>
          <canvas id="timeChart" width="300" height="200"></canvas>
        </div>
        
        <div class="analytics-card">
          <h3>Topic Mastery</h3>
          <div id="topicMastery" class="topic-mastery"></div>
        </div>
        
        <div class="analytics-card">
          <h3>Learning Insights</h3>
          <div id="learningInsights" class="insights-list"></div>
        </div>
      </div>
    </section>

    <!-- Achievements System -->
    <section id="achievements" class="card hidden">
      <div class="achievements-header">
        <h2>Achievements & Badges</h2>
        <button id="closeAchievements" class="icon-btn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M18 6L6 18M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      
      <div class="achievements-grid" id="achievementsList"></div>
    </section>

    <!-- Social Features -->
    <section id="social" class="card hidden">
      <div class="social-header">
        <h2>Study Groups & Challenges</h2>
        <div class="header-actions">
          <div id="userStatus" class="user-status">
            <span id="userInfo">Sign in for global leaderboard</span>
            <button id="authBtn" class="ghost small">Sign In</button>
          </div>
          <button id="closeSocial" class="icon-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M18 6L6 18M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>
      
      <div class="social-tabs">
        <button class="tab-btn active" data-tab="leaderboard">Leaderboard</button>
        <button class="tab-btn" data-tab="challenges">Challenges</button>
        <button class="tab-btn" data-tab="groups">Study Groups</button>
        <button class="tab-btn" data-tab="account">Account</button>
      </div>
      
      <div class="social-content">
        <div id="leaderboard" class="tab-content active">
          <div class="leaderboard-controls">
            <label for="subjectFilter">Subject:</label>
            <select id="subjectFilter">
              <option value="all">All Subjects</option>
              <option value="mathematics">Mathematics</option>
              <option value="english">English</option>
              <option value="physics">Physics</option>
              <option value="chemistry">Chemistry</option>
              <option value="biology">Biology</option>
              <option value="economics">Economics</option>
              <option value="government">Government</option>
              <option value="literature">Literature</option>
              <option value="geography">Geography</option>
              <option value="commerce">Commerce</option>
              <option value="accounting">Accounting</option>
              <option value="agricultural_science">Agricultural Science</option>
            </select>
            <button id="refreshLeaderboard" class="outline small">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
              </svg>
              Refresh
            </button>
          </div>
          <div id="leaderboardList" class="leaderboard-list">
            <div class="loading-placeholder">Loading leaderboard...</div>
          </div>
        </div>
        <div id="challenges" class="tab-content hidden"></div>
        <div id="groups" class="tab-content hidden"></div>
        <div id="account" class="tab-content hidden">
          <div id="loginForm" class="auth-form">
            <h3>Create Account or Sign In</h3>
            <div class="form-group">
              <label for="authEmail">Email</label>
              <input type="email" id="authEmail" placeholder="your.email@example.com" required>
            </div>
            <div class="form-group">
              <label for="authPassword">Password</label>
              <input type="password" id="authPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
            </div>
            <div class="form-group" id="displayNameGroup" style="display: none;">
              <label for="authDisplayName">Display Name</label>
              <input type="text" id="authDisplayName" placeholder="Your Name">
            </div>
            <div class="form-actions">
              <button id="signInBtn" class="primary">Sign In</button>
              <button id="createAccountBtn" class="outline">Create Account</button>
              <button id="anonymousBtn" class="ghost small">Continue as Guest</button>
            </div>
          </div>
          <div id="userProfile" class="user-profile hidden">
            <h3>Your Profile</h3>
            <div id="profileInfo"></div>
            <div class="form-actions">
              <button id="syncDataBtn" class="primary">Sync Data</button>
              <button id="signOutBtn" class="outline">Sign Out</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="setup" class="card animate-slide-in-right">
      <h2>Start a session</h2>
      <div class="quick-start">
        <button class="chip" type="button" data-quick="practice" data-questions="10">Quick 10</button>
        <button class="chip" type="button" data-quick="practice" data-questions="20">Quick 20</button>
        <button class="chip" type="button" data-quick="timed" data-questions="30" data-minutes="30">Timed 30</button>
        <button class="chip" type="button" data-quick="timed" data-questions="40" data-minutes="45">Timed 45</button>
        <button class="chip" type="button" data-quick="exam" data-questions="60" data-seconds="90">WAEC 60</button>
      </div>
      <div class="setup__stats">
        <div class="stat">
          <span class="stat__label">Streak</span>
          <span id="streakStat" class="stat__value">0 days</span>
        </div>
        <div class="stat">
          <span class="stat__label">Daily goal</span>
          <span id="goalStat" class="stat__value">0 / 20</span>
        </div>
        <div class="stat stat--input">
          <label class="stat__label" for="dailyGoalInput">Set daily goal</label>
          <input id="dailyGoalInput" type="number" min="5" max="200" value="20" />
          <span class="stat__hint muted small">Questions per day</span>
        </div>
      </div>
      <div class="player-setup">
        <label class="player-name-label">
          <span class="label-text">Your Name (for Leaderboard)</span>
          <input id="playerName" type="text" placeholder="Enter your name..." maxlength="20" />
          <span class="hint-text">Optional - leave blank for anonymous practice</span>
        </label>
      </div>

      <div class="grid">
        <label>
          Subject
          <select id="subjectSelect">
            <option value="mathematics">Mathematics</option>
            <option value="english">English</option>
            <option value="physics">Physics</option>
            <option value="chemistry">Chemistry</option>
            <option value="biology">Biology</option>
            <option value="economics">Economics</option>
            <option value="government">Government</option>
            <option value="literature">Literature</option>
            <option value="geography">Geography</option>
            <option value="commerce">Commerce</option>
            <option value="accounting">Accounting</option>
            <option value="agricultural_science">Agricultural Science</option>
          </select>
        </label>

        <label>
          Mode
          <select id="modeSelect">
            <option value="practice">Practice</option>
            <option value="timed">Timed Exam</option>
            <option value="exam">Exam (WAEC style)</option>
          </select>
        </label>

        <label>
          Topic
          <select id="topicSelect">
            <option value="all">All topics</option>
          </select>
        </label>

        <label>
          Difficulty
          <select id="difficultySelect">
            <option value="all">All levels</option>
            <option value="easy">Easy</option>
            <option value="medium">Medium</option>
            <option value="hard">Hard</option>
          </select>
        </label>

        <label>
          Questions
          <input id="questionCount" type="number" min="5" max="150" value="20" />
        </label>

        <label id="timeWrap" class="hidden">
          Time (minutes)
          <input id="timeLimit" type="number" min="5" max="180" value="30" />
        </label>

        <label class="toggle">
          <span>Auto-advance</span>
          <input id="autoAdvance" type="checkbox" checked />
          <span class="toggle__slider"></span>
        </label>
      </div>

      <div id="examSettings" class="exam-settings hidden">
        <div class="exam-settings__header">
          <h3>Exam mode settings</h3>
          <button id="applyWaecPreset" class="ghost small" type="button">Use WAEC preset</button>
        </div>
        <div class="exam-settings__grid">
          <label>
            Easy %
            <input id="examEasy" type="number" min="0" max="100" value="25" />
          </label>
          <label>
            Medium %
            <input id="examMedium" type="number" min="0" max="100" value="50" />
          </label>
          <label>
            Hard %
            <input id="examHard" type="number" min="0" max="100" value="25" />
          </label>
          <label>
            Seconds per question
            <input id="examSecondsPerQuestion" type="number" min="30" max="180" value="85" />
          </label>
        </div>
        <p id="examMixHint" class="muted small"></p>
      </div>

      <button id="startBtn" class="primary" type="button">Start</button>
      <p id="setupNote" class="muted small"></p>
      <p class="muted small">Questions are demo placeholders, not past WAEC items.</p>
    </section>

    <section id="quiz" class="card hidden" aria-live="polite">
      <div class="quiz__top">
        <div>
          <div id="progressText" class="muted small">Question 1 of 20</div>
          <div class="progress">
            <div id="progressBar" class="progress__bar" style="width: 0%"></div>
          </div>
        </div>
        <div class="quiz__meta">
          <span id="topicBadge" class="badge">Topic</span>
          <div id="timer" class="timer hidden">30:00</div>
        </div>
      </div>

      <h3 id="questionText">Loading...</h3>
      <p class="muted small">Tap an option to answer.</p>
      <div id="options" class="options"></div>

      <div id="explanation" class="explanation hidden">
        <div id="answerFeedback" class="feedback"></div>
        <div id="explanationText" class="muted"></div>
      </div>

      <div class="quiz__actions">
        <button id="nextBtn" class="primary" type="button">Next</button>
        <button id="finishBtn" class="ghost" type="button">Finish</button>
      </div>
    </section>

    <section id="dashboard" class="card">
      <div class="dashboard__header">
        <h2>Topic dashboard</h2>
        <p class="muted small">Track your strengths and weak areas across subjects.</p>
      </div>
      <div id="dashboardContent" class="dashboard__content"></div>
    </section>

    <section id="summary" class="card hidden">
      <h2>Session summary</h2>
      <div id="scoreSummary" class="summary__score"></div>
      <div class="summary__grid">
        <div class="summary__panel">
          <h3>Focus areas</h3>
          <div id="weakTopics" class="summary__weak"></div>
          <div id="topicBreakdown" class="summary__breakdown"></div>
        </div>
        <div class="summary__panel">
          <h3>Progress</h3>
          <div id="history" class="summary__history"></div>
          <div id="streakSummary" class="summary__streak"></div>
          <div id="goalSummary" class="summary__goal"></div>
        </div>
      </div>
      <div id="reviewActions" class="summary__actions hidden">
        <button id="reviewBtn" class="ghost" type="button">Review missed questions</button>
      </div>
      <div id="missedList" class="summary__missed"></div>
      <button id="restartBtn" class="primary" type="button">Practice again</button>
    </section>
  </main>

  <noscript>
    <p class="noscript">Please enable JavaScript to use the app.</p>
  </noscript>

  <!-- Firebase SDK (optional - for real-time leaderboard and user accounts) -->
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-analytics-compat.js"></script>
  
  <!-- Core application scripts -->
  <script src="./js/data-loader.js" defer></script>
  <script src="./js/firebase-config.js" defer></script>
  <script src="./js/ai-engine.js" defer></script>
  <script src="./js/achievements.js" defer></script>
  <script src="./js/voice-engine.js" defer></script>
  <script src="./js/analytics.js" defer></script>
  <script src="./js/feedback.js" defer></script>
  <script src="./js/app.js" defer></script>
</body>
</html>
